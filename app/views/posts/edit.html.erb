<% provide(:title,"Edit post") %>
<h1>投稿編集</h1>
<div class="row">
  <div class="col-md-8 col-md-offset-2">
    <%= form_with(model:@post,url:post_path(@post),mehod: :patch ,local: true) do |f| %>
      <%= render 'shared/error_messages',resource:@post %>
      
      <%= f.label:university, class: "label-form" %>
      <%= f.text_field:university, class: "form-control" %>
      
      <%= f.label:department, class: "label-form" %>
      <%= f.text_field:department, class: "form-control" %>
      
      <%= f.label:branch, class:"label-form" %>
      <%= f.text_field:branch, class:"form-control" %>
      
      <%= f.label :title, class: "label-form" %>
      <%= f.text_field :title, class: "form-control" %>
      
      <%= f.label :description, class: "label-form" %>
      <%= f.text_area :description, rows:10, class: "form-control" %>
      
      <%= f.label :img, class: "label-form" %>
      <%= f.file_field :img, id: :post_img %>
      <p><%= f.check_box :remove_img %>画像を削除する</p>
      
      <!--プレビューが表示されるエリア-->
      <%= image_tag @post.img.url, id: :img_prev if @post.img? %>
      
      <%= f.hidden_field:user_id, :value => current_user.id %>

      <%= f.submit "更新", class: "btn btn-primary btn-form" %>
      <%= link_to "キャンセル",posts_path,class: "btn btn-primary btn-form" %>
    <% end %>
    
  </div>
</div>


<!--選択した写真のプレビューを表示する-->
<script type="text/javascript">
$(function() {
 function readURL(input) {
   if (input.files && input.files[0]) {
     var reader = new FileReader();
     reader.onload = function (e) {
       $('#img_prev').attr('src', e.target.result);
     }
     reader.readAsDataURL(input.files[0]);
   }
 }
 $("#post_img").change(function(){
   readURL(this);
 });
});
</script>